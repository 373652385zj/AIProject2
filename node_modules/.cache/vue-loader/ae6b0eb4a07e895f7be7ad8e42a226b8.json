{"remainingRequest":"/Volumes/JAKY/温博老师给的任务/网页UI/node_modules/vue-loader/lib/index.js??vue-loader-options!/Volumes/JAKY/温博老师给的任务/网页UI/src/ParkingDetector/Status.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Volumes/JAKY/温博老师给的任务/网页UI/src/ParkingDetector/Status.vue","mtime":1600847904000},{"path":"/Volumes/JAKY/温博老师给的任务/网页UI/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/JAKY/温博老师给的任务/网页UI/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Volumes/JAKY/温博老师给的任务/网页UI/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/JAKY/温博老师给的任务/网页UI/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBQdWJTdWIgZnJvbSAicHVic3ViLWpzIjsKCmNsYXNzIFBhcmtpbmdTcGFjZVN0b3JhZ2UgewogICAgLy/kuI5kYXJrbmV0LnZ1ZemHjOmdoueahOWQjOWQjeexu+WMuuWIq++8mui/meS4quexu+S4u+imgeWCqOWtmOS9jee9ruS/oeaBr+WSjElE5L+h5oGv77yMZGFya25ldC52dWXph4znmoTkuLvopoHmjqfliLbmmL7npLoKICAgIGNvbnN0cnVjdG9yKCkgewogICAgICAgIHRoaXMuc3RvcmFnZSA9IFtdOwogICAgICAgIHRoaXMuYXZhaWxhYmxlID0gMDsKICAgIH0KCiAgICBhZGQoeCwgeSwgaWQsIG5hbWUpIHsKICAgICAgICB0aGlzLnN0b3JhZ2UucHVzaCh7eCwgeSwgaWQsIG5hbWUsIGF2YWlsYWJsZTogdHJ1ZX0pOwogICAgICAgIHRoaXMuc3RvcmFnZS5zb3J0KChhLCBiKSA9PiB7CiAgICAgICAgICAgIHJldHVybiBhLm5hbWUgPiBiLm5hbWUgPyAxIDogLTEKICAgICAgICB9KQogICAgICAgIHRoaXMucmVmcmVzaEF2YWlsYWJpbGl0eSgpCiAgICB9CgogICAgcmVtb3ZlKGlkKSB7CiAgICAgICAgZm9yIChsZXQgaSBpbiB0aGlzLnN0b3JhZ2UpIHsKICAgICAgICAgICAgaWYgKHRoaXMuc3RvcmFnZVtpXS5pZCA9PSBpZCkgewogICAgICAgICAgICAgICAgdGhpcy5zdG9yYWdlLnNwbGljZShpLCAxKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB0aGlzLnJlZnJlc2hBdmFpbGFiaWxpdHkoKQogICAgfQoKICAgIHJlbmFtZShpZCwgbmFtZSkgewogICAgICAgIGZvciAobGV0IGkgaW4gdGhpcy5zdG9yYWdlKSB7CiAgICAgICAgICAgIGlmICh0aGlzLnN0b3JhZ2VbaV0uaWQgPT0gaWQpIHsKICAgICAgICAgICAgICAgIHRoaXMuc3RvcmFnZVtpXS5uYW1lID0gbmFtZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB0aGlzLnN0b3JhZ2Uuc29ydCgoYSwgYikgPT4gewogICAgICAgICAgICByZXR1cm4gYS5uYW1lID4gYi5uYW1lID8gMSA6IC0xCiAgICAgICAgfSkKICAgIH0KCiAgICBjaGFuZ2UoaWQsIGF2YWlsYWJsZSkgewogICAgICAgIGZvciAobGV0IGkgaW4gdGhpcy5zdG9yYWdlKSB7CiAgICAgICAgICAgIGlmICh0aGlzLnN0b3JhZ2VbaV0uaWQgPT0gaWQpIHsKICAgICAgICAgICAgICAgIHRoaXMuc3RvcmFnZVtpXS5hdmFpbGFibGUgPSBhdmFpbGFibGU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdGhpcy5yZWZyZXNoQXZhaWxhYmlsaXR5KCkKICAgIH0KCiAgICByZWZyZXNoQXZhaWxhYmlsaXR5KCkgewogICAgICAgIGxldCBjb3VudGVyID0gMAogICAgICAgIHRoaXMuc3RvcmFnZS5mb3JFYWNoKGUgPT4gewogICAgICAgICAgICBpZiAoZS5hdmFpbGFibGUpIGNvdW50ZXIrKwogICAgICAgIH0pCiAgICAgICAgdGhpcy5hdmFpbGFibGUgPSBjb3VudGVyCiAgICB9Cn0KCmV4cG9ydCBkZWZhdWx0IHsKICAgIG5hbWU6ICJzdGF0dXMiLAogICAgZGF0YTogZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHBhcmtpbmdTcGFjZVN0b3JhZ2U6IG51bGwsCiAgICAgICAgICAgIGhlaWdodDogMCwKICAgICAgICAgICAgZWRpdGluZzogewogICAgICAgICAgICAgICAgaWQ6ICIiLAogICAgICAgICAgICAgICAgbmFtZTogIiIsCiAgICAgICAgICAgIH0sCiAgICAgICAgfTsKICAgIH0sCiAgICBtZXRob2RzOiB7CiAgICAgICAgc2hvd1JlbmFtZUJveDogZnVuY3Rpb24gKGlkLCBuYW1lKSB7CiAgICAgICAgICAgIHRoaXMuZWRpdGluZy5pZCA9IGlkOwogICAgICAgICAgICB0aGlzLmVkaXRpbmcubmFtZSA9IG5hbWU7CiAgICAgICAgICAgIHRoaXMuJGJ2TW9kYWwuc2hvdygicGFya2luZy1yZW5hbWUiKTsKICAgICAgICB9LAogICAgICAgIHJlbmFtZUNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIFB1YlN1Yi5wdWJsaXNoKCJyZW5hbWUiLCB7CiAgICAgICAgICAgICAgICBpZDogdGhpcy5lZGl0aW5nLmlkLAogICAgICAgICAgICAgICAgbmFtZTogdGhpcy5lZGl0aW5nLm5hbWUsCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB0aGlzLnJlc2V0Rm9ybSgpOwogICAgICAgIH0sCiAgICAgICAgcmVzZXRGb3JtOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHRoaXMuZWRpdGluZy5pZCA9ICIiOwogICAgICAgICAgICB0aGlzLmVkaXRpbmcubmFtZSA9ICIiOwogICAgICAgIH0sCiAgICAgICAgaGlnaGxpZ2h0OiBmdW5jdGlvbiAoaWQpIHsKICAgICAgICAgICAgUHViU3ViLnB1Ymxpc2goImhpZ2hsaWdodCIsIGlkKTsKICAgICAgICB9LAogICAgfSwKICAgIGNyZWF0ZWQ6IGZ1bmN0aW9uICgpIHsKICAgICAgICB0aGlzLnBhcmtpbmdTcGFjZVN0b3JhZ2UgPSBuZXcgUGFya2luZ1NwYWNlU3RvcmFnZSgpOwogICAgICAgIFB1YlN1Yi5zdWJzY3JpYmUoImNyZWF0ZSIsIChtc2csIHBvaW50KSA9PiB7CiAgICAgICAgICAgIHRoaXMucGFya2luZ1NwYWNlU3RvcmFnZS5hZGQocG9pbnQueCwgcG9pbnQueSwgcG9pbnQuaWQsIHBvaW50Lm5hbWUpOwogICAgICAgIH0pOwogICAgICAgIFB1YlN1Yi5zdWJzY3JpYmUoInJlbW92ZSIsIChtc2csIGlkKSA9PiB7CiAgICAgICAgICAgIHRoaXMucGFya2luZ1NwYWNlU3RvcmFnZS5yZW1vdmUoaWQpOwogICAgICAgIH0pOwogICAgICAgIFB1YlN1Yi5zdWJzY3JpYmUoImNoYW5nZSIsIChtc2csIHBheWxvYWQpID0+IHsKICAgICAgICAgICAgdGhpcy5wYXJraW5nU3BhY2VTdG9yYWdlLmNoYW5nZShwYXlsb2FkLmlkLCBwYXlsb2FkLmF2YWlsYWJsZSk7CiAgICAgICAgfSk7CiAgICAgICAgUHViU3ViLnN1YnNjcmliZSgicmVuYW1lIiwgKG1zZywgcGF5bG9hZCkgPT4gewogICAgICAgICAgICB0aGlzLnBhcmtpbmdTcGFjZVN0b3JhZ2UucmVuYW1lKHBheWxvYWQuaWQsIHBheWxvYWQubmFtZSk7CiAgICAgICAgfSk7CiAgICB9LAogICAgY29tcHV0ZWQ6IHsKICAgICAgICBhdmFpbGFibGVPbmx5OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGxldCBkYXRhID0gW10KICAgICAgICAgICAgdGhpcy5wYXJraW5nU3BhY2VTdG9yYWdlLnN0b3JhZ2UuZm9yRWFjaChlID0+IHsKICAgICAgICAgICAgICAgIGlmIChlLmF2YWlsYWJsZSkgZGF0YS5wdXNoKGUpCiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIHJldHVybiBkYXRhCiAgICAgICAgfQogICAgfQp9Owo="},{"version":3,"sources":["Status.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiDA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Status.vue","sourceRoot":"src/ParkingDetector","sourcesContent":["<template>\r\n    <b-card id=\"parkingListContainer\" body-class=\"overflow-auto maxh\">\r\n        <template v-slot:header>\r\n            车位列表 | 现有车位{{ parkingSpaceStorage.storage.length }}个\r\n            <b-progress :max=\"parkingSpaceStorage.storage.length\" show-value class=\"mt-3\">\r\n                <b-progress-bar :value=\"parkingSpaceStorage.available\" variant=\"success\"/>\r\n                <b-progress-bar :value=\"parkingSpaceStorage.storage.length - parkingSpaceStorage.available\"\r\n                                variant=\"danger\"/>\r\n            </b-progress>\r\n        </template>\r\n        <b-table-simple small hover>\r\n            <b-thead>\r\n                <b-tr>\r\n                    <b-th>车位号</b-th>\r\n                    <b-th>状态</b-th>\r\n                </b-tr>\r\n            </b-thead>\r\n            <b-tbody>\r\n                <b-tr\r\n                        v-for=\"space in parkingSpaceStorage.storage\"\r\n                        :key=\"space.id\"\r\n                        :variant=\"space.available ? 'success' : 'danger'\"\r\n                        @click=\"showRenameBox(space.id, space.name)\"\r\n                        @mouseenter=\"highlight(space.id)\"\r\n                        @mouseleave=\"highlight('')\"\r\n                >\r\n                    <b-td>{{ space.name }}</b-td>\r\n                    <b-td>{{ space.available ? \"空闲\" : \"占用\" }}</b-td>\r\n                </b-tr>\r\n            </b-tbody>\r\n        </b-table-simple>\r\n        <b-modal\r\n                id=\"parking-rename\"\r\n                title=\"车位重命名\"\r\n                size=\"lg\"\r\n                cancel-title=\"取消\"\r\n                ok-title=\"确定\"\r\n                @ok=\"renameComplete\"\r\n                @cancel=\"resetForm\"\r\n                @close=\"resetForm\"\r\n                body-class=\"justify-content-center\"\r\n        >\r\n            <label for=\"editID\">车位号</label>\r\n            <b-form-input id=\"editID\" v-model=\"editing.name\" type=\"text\"/>\r\n        </b-modal>\r\n    </b-card>\r\n</template>\r\n\r\n<script>\r\n    import PubSub from \"pubsub-js\";\r\n\r\n    class ParkingSpaceStorage {\r\n        //与darknet.vue里面的同名类区别：这个类主要储存位置信息和ID信息，darknet.vue里的主要控制显示\r\n        constructor() {\r\n            this.storage = [];\r\n            this.available = 0;\r\n        }\r\n\r\n        add(x, y, id, name) {\r\n            this.storage.push({x, y, id, name, available: true});\r\n            this.storage.sort((a, b) => {\r\n                return a.name > b.name ? 1 : -1\r\n            })\r\n            this.refreshAvailability()\r\n        }\r\n\r\n        remove(id) {\r\n            for (let i in this.storage) {\r\n                if (this.storage[i].id == id) {\r\n                    this.storage.splice(i, 1);\r\n                    return;\r\n                }\r\n            }\r\n            this.refreshAvailability()\r\n        }\r\n\r\n        rename(id, name) {\r\n            for (let i in this.storage) {\r\n                if (this.storage[i].id == id) {\r\n                    this.storage[i].name = name;\r\n                }\r\n            }\r\n            this.storage.sort((a, b) => {\r\n                return a.name > b.name ? 1 : -1\r\n            })\r\n        }\r\n\r\n        change(id, available) {\r\n            for (let i in this.storage) {\r\n                if (this.storage[i].id == id) {\r\n                    this.storage[i].available = available;\r\n                }\r\n            }\r\n            this.refreshAvailability()\r\n        }\r\n\r\n        refreshAvailability() {\r\n            let counter = 0\r\n            this.storage.forEach(e => {\r\n                if (e.available) counter++\r\n            })\r\n            this.available = counter\r\n        }\r\n    }\r\n\r\n    export default {\r\n        name: \"status\",\r\n        data: function () {\r\n            return {\r\n                parkingSpaceStorage: null,\r\n                height: 0,\r\n                editing: {\r\n                    id: \"\",\r\n                    name: \"\",\r\n                },\r\n            };\r\n        },\r\n        methods: {\r\n            showRenameBox: function (id, name) {\r\n                this.editing.id = id;\r\n                this.editing.name = name;\r\n                this.$bvModal.show(\"parking-rename\");\r\n            },\r\n            renameComplete: function () {\r\n                PubSub.publish(\"rename\", {\r\n                    id: this.editing.id,\r\n                    name: this.editing.name,\r\n                });\r\n                this.resetForm();\r\n            },\r\n            resetForm: function () {\r\n                this.editing.id = \"\";\r\n                this.editing.name = \"\";\r\n            },\r\n            highlight: function (id) {\r\n                PubSub.publish(\"highlight\", id);\r\n            },\r\n        },\r\n        created: function () {\r\n            this.parkingSpaceStorage = new ParkingSpaceStorage();\r\n            PubSub.subscribe(\"create\", (msg, point) => {\r\n                this.parkingSpaceStorage.add(point.x, point.y, point.id, point.name);\r\n            });\r\n            PubSub.subscribe(\"remove\", (msg, id) => {\r\n                this.parkingSpaceStorage.remove(id);\r\n            });\r\n            PubSub.subscribe(\"change\", (msg, payload) => {\r\n                this.parkingSpaceStorage.change(payload.id, payload.available);\r\n            });\r\n            PubSub.subscribe(\"rename\", (msg, payload) => {\r\n                this.parkingSpaceStorage.rename(payload.id, payload.name);\r\n            });\r\n        },\r\n        computed: {\r\n            availableOnly: function () {\r\n                let data = []\r\n                this.parkingSpaceStorage.storage.forEach(e => {\r\n                    if (e.available) data.push(e)\r\n                })\r\n                return data\r\n            }\r\n        }\r\n    };\r\n</script>\r\n\r\n<style scoped>\r\n    .maxh {\r\n        max-height: 75vh;\r\n    }\r\n</style>"]}]}